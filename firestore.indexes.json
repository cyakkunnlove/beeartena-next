{
  "indexes": [
    {
      "__comment": "既存のインデックス - 日付とステータスでのフィルタリング",
      "collectionGroup": "reservations",
      "queryScope": "COLLECTION",
      "fields": [
        {
          "fieldPath": "date",
          "order": "ASCENDING"
        },
        {
          "fieldPath": "status",
          "order": "ASCENDING"
        }
      ]
    },
    {
      "__comment": "既存のインデックス - ユーザー別予約の取得（降順）",
      "collectionGroup": "reservations",
      "queryScope": "COLLECTION",
      "fields": [
        {
          "fieldPath": "customerId",
          "order": "ASCENDING"
        },
        {
          "fieldPath": "date",
          "order": "DESCENDING"
        }
      ]
    },
    {
      "__comment": "既存のインデックス - 日付と時間でのソート",
      "collectionGroup": "reservations",
      "queryScope": "COLLECTION",
      "fields": [
        {
          "fieldPath": "date",
          "order": "ASCENDING"
        },
        {
          "fieldPath": "time",
          "order": "ASCENDING"
        }
      ]
    },
    {
      "__comment": "顧客管理: 役割フィルタと作成日時の降順ソート",
      "collectionGroup": "users",
      "queryScope": "COLLECTION",
      "fields": [
        {
          "fieldPath": "role",
          "order": "ASCENDING"
        },
        {
          "fieldPath": "createdAt",
          "order": "DESCENDING"
        }
      ]
    },
    {
      "__comment": "最適化: 月次availability確認用の複合インデックス",
      "collectionGroup": "reservations",
      "queryScope": "COLLECTION",
      "fields": [
        {
          "fieldPath": "date",
          "order": "ASCENDING"
        },
        {
          "fieldPath": "status",
          "order": "ASCENDING"
        }
      ]
    },
    {
      "__comment": "集約クエリ: status == 'confirmed' かつ date >= today",
      "collectionGroup": "reservations",
      "queryScope": "COLLECTION",
      "fields": [
        {
          "fieldPath": "status",
          "order": "ASCENDING"
        },
        {
          "fieldPath": "date",
          "order": "ASCENDING"
        }
      ]
    },
    {
      "__comment": "サービスプラン: 公開状態と表示順でのソート",
      "collectionGroup": "service-plans",
      "queryScope": "COLLECTION",
      "fields": [
        {
          "fieldPath": "isPublished",
          "order": "ASCENDING"
        },
        {
          "fieldPath": "displayOrder",
          "order": "ASCENDING"
        }
      ]
    },
    {
      "__comment": "お知らせ: 公開日と優先度でのソート",
      "collectionGroup": "announcements",
      "queryScope": "COLLECTION",
      "fields": [
        {
          "fieldPath": "publishAt",
          "order": "DESCENDING"
        },
        {
          "fieldPath": "priority",
          "order": "DESCENDING"
        }
      ]
    },
    {
      "__comment": "管理画面: ステータス別の最新予約一覧",
      "collectionGroup": "reservations",
      "queryScope": "COLLECTION",
      "fields": [
        {
          "fieldPath": "status",
          "order": "ASCENDING"
        },
        {
          "fieldPath": "createdAt",
          "order": "DESCENDING"
        }
      ]
    },
    {
      "__comment": "管理画面: 顧客別の最新予約一覧",
      "collectionGroup": "reservations",
      "queryScope": "COLLECTION",
      "fields": [
        {
          "fieldPath": "customerId",
          "order": "ASCENDING"
        },
        {
          "fieldPath": "createdAt",
          "order": "DESCENDING"
        }
      ]
    },
    {
      "__comment": "管理画面: 顧客＋ステータス絞り込みの最新予約",
      "collectionGroup": "reservations",
      "queryScope": "COLLECTION",
      "fields": [
        {
          "fieldPath": "customerId",
          "order": "ASCENDING"
        },
        {
          "fieldPath": "status",
          "order": "ASCENDING"
        },
        {
          "fieldPath": "createdAt",
          "order": "DESCENDING"
        }
      ]
    }
  ],
  "fieldOverrides": [
    {
      "__comment": "dateフィールドのインデックス最適化",
      "collectionGroup": "reservations",
      "fieldPath": "date",
      "indexes": [
        {
          "order": "ASCENDING",
          "queryScope": "COLLECTION"
        },
        {
          "order": "DESCENDING",
          "queryScope": "COLLECTION"
        }
      ]
    },
    {
      "__comment": "statusフィールドのarray-containsクエリ最適化",
      "collectionGroup": "reservations",
      "fieldPath": "status",
      "indexes": [
        {
          "order": "ASCENDING",
          "queryScope": "COLLECTION"
        },
        {
          "arrayConfig": "CONTAINS",
          "queryScope": "COLLECTION"
        }
      ]
    }
  ]
}
