# ポイント機能デバッグ手順

## 実装した機能

### 1. 管理者側機能
- **ポイント管理画面** (`/admin/points`)
  - ポイント付与・使用機能
  - ポイント履歴の表示
  - 統計情報（総発行ポイント、総使用ポイント等）

- **顧客詳細画面** (`/admin/customers/[id]`)
  - ポイント履歴タブの追加
  - 顧客のポイント残高表示

### 2. 顧客側機能
- **予約画面** (`/reservation`)
  - ポイント使用オプション
  - 使用ポイント数の入力
  - 支払い金額の自動計算

## テスト手順

### 1. 管理者でポイント付与
1. 管理者アカウントでログイン
2. 管理画面 → ポイント管理へ移動
3. 「ポイント付与」ボタンをクリック
4. 顧客を選択し、ポイント数と理由を入力
5. ポイントが付与されることを確認

### 2. 顧客でポイント使用
1. ポイントを付与された顧客アカウントでログイン
2. 予約画面へ移動
3. サービス、日時を選択
4. お客様情報入力画面で「ポイントを使用する」にチェック
5. 使用するポイント数を入力
6. 支払い金額が正しく計算されることを確認
7. 予約を完了

### 3. ポイント履歴の確認
1. 管理者でログイン
2. 顧客管理 → 該当顧客の詳細画面へ
3. 「ポイント履歴」タブをクリック
4. ポイント付与と使用の履歴が表示されることを確認

## デバッグポイント

1. **ポイント残高の更新**
   - ポイント使用後、顧客の残高が正しく減少しているか
   - localStorage の `users` と `points` が正しく更新されているか

2. **予約データの保存**
   - `finalPrice`（ポイント使用後の金額）が正しく保存されているか
   - `pointsUsed` が予約データに含まれているか

3. **ポイント履歴の記録**
   - type が `redeemed`（使用）として記録されているか
   - amount がマイナス値で記録されているか

## 動作確認URL

- 開発環境: http://localhost:3000
- 管理画面: http://localhost:3000/admin
- ポイント管理: http://localhost:3000/admin/points
- 予約画面: http://localhost:3000/reservation